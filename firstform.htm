<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Imggallery</title>
<link href="style.css"rel="stylesheet" type="text/css" />
<script type="text/javascript" charset="utf-8" src="cordova.js"></script>
<script type="text/javascript" src="jquery-1.9.1.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
document.addEventListener("deviceready", onDeviceReady, false);
     
    var db = window.openDatabase("Database", "1.0", "gps", 200000);
 
    function onDeviceReady(){
        //Populate the databse
        db.transaction(populateDB, errorCB, successCB);
        
        
    }
    
    function populateDB(tx){
        //Create the table
        //tx.executeSql('DROP TABLE IF EXISTS MyContacts');
        tx.executeSql('CREATE TABLE IF NOT EXISTS gps (id INTEGER PRIMARY KEY AUTOINCREMENT,idval VARCHAR(50),location VARCHAR(30), start_time VARCHAR(30), cycle_length VARCHAR(30),arrival_open VARCHAR(30), arrival_close VARCHAR(30))');
        
    }
    
     function successCB() {
          
            alert("table created successfully");
        }
   function errorCB2(err)
   {
   	alert("sqlerror:"+err.message);
   }
	
 $("#save").bind ("click", function (event){
     
     
      var str="'A'";
         $('.A').each(function(){
          
      var loca=($(this).val());
      var y=($(this).attr('col_val'));
      
      str= str +",'"+loca+"'";
   

		  
    		});
     
      var str2="'B'";
         $('.B').each(function(){
          
      var locb=($(this).val());
      var yb=($(this).attr('col_val'));
       str2= str2 +",'"+locb+"'";
      
      
   

      
    		});
   
    
    var str3="'C'";
         $('.C').each(function(){
          
      var locc=($(this).val());
      var yc=($(this).attr('col_val'));
      str3= str3 +",'"+locc+"'";
		 });
   
     var db = window.openDatabase("Database", "1.0", "gps", 200000);
     
	          db.transaction(function (tx){ 
	          	
	          	var id = $("#id").val();
	          	alert(id);
	          	if (id == ''){
	          	var unqid = new Date().getTime();
			alert("if");
	          	//alert("INSERT INTO gps(location,start_time,cycle_length,arrival_open,arrival_close)VALUES("+str+")");
	          //	alert("INSERT INTO gps set "+str);
	          //alert("INSERT INTO gps(idval,location,start_time,cycle_length,arrival_open,arrival_close) VALUES ("+unqid+","+str+")");
tx.executeSql("INSERT INTO gps(idval,location,start_time,cycle_length,arrival_open,arrival_close) VALUES ("+unqid+","+str+")");
tx.executeSql("INSERT INTO gps(idval,location,start_time,cycle_length,arrival_open,arrival_close) VALUES ("+unqid+","+str2+")");
tx.executeSql("INSERT INTO gps(idval,location,start_time,cycle_length,arrival_open,arrival_close) VALUES ("+unqid+","+str3+")");
	          //tx.executeSql("INSERT INTO gps set "+ str2);
	          //tx.executeSql("INSERT INTO gps set "+ str3);
	          	}
	          	else
	          	{
	          		alert("else");
alert("UPDATE gps SET idval=?, location=?, start_time=?, cycle_length=?, arrival_open=?, arrival_close=?  WHERE idval=? ",[unqid,str,id]);	          		
	          	
//tx.executeSql("UPDATE gps SET idval=?, location=?, start_time=?, cycle_length=?, arrival_open=?, arrival_close=?  WHERE idval=? ",[unqid,str,id]); 
  	          	
	          		
	          		
	          		
	          	}
	         
	          });
          
 });
 
 
function queryDB(tx) {
            tx.executeSql('SELECT * FROM gps', [], querySuccess, errorCB1);
            
        }


// Query the success callback
        //
        function querySuccess(tx, results) {
            var len = results.rows.length;
            //alert("gps table: " + len + " rows found.");
            for (var i=0; i<len; i++){
           $('#userList').append('<tr><td>'+results.rows.item(i).location+'</td>'+'<td>'+results.rows.item(i).start_time+'</td>'
            +'<td>'+results.rows.item(i).cycle_length+'</td>'+'<td>'+results.rows.item(i).arrival_open+'</td>'
            +'<td>'+results.rows.item(i).arrival_close+'</td></tr>');
            
            $('#id').val(results.rows.item(i).idval);
            //$('#userList').append('<li>'+results.rows.item(i).start_time+'</li>');



            }
            

        }

        // Transaction error callback
        //
        function errorCB(err) {
            alert("Error processing SQL: "+err.message);
        }
    
    function errorCB1(err)
    {
    	alert("Error processing SQL of querySuccess: "+err.message)
    }
     
     $("#chk").click(function(){
     	 var db = window.openDatabase("Database", "1.0", "gps", 200000);
     	db.transaction(queryDB, errorCB, successCB);
     	
     });
 
});
        //var workPhoneNumber = $.trim($("#workPhoneNumber").val()).replace(/[^0-9-]/g, '');
        //var emailId = $.trim($("#emailId").val());
        //var website = $.trim($("#website").val());
        //var happyBirthDay = $.trim($("#happyBirthDay").val());
        //console.log(name+' '+nickName+' '+mobilePhoneNumber+' '+workPhone

</script>

      
      
</head>

<body>
	<div id="topbar">
	<input type="button" id="chk" value="chk"/>
			<div id="top_box">
					<h2 style="text-align:center; text-shadow:#000000 1px">
					Arrival Time Demo App
					</h2>	
					<p class="text">
							Edit Parameters <br /> Tap any Cell to Edit
					</p>		
			</div>
	</div>
	
	
	<div id="contentbar">
			<div id="content_box">
				
					<table id="table1" style="height:300px;">
							<tr>
									<td>
											
									</td>
									<td align="center">
											Location<br />
											A

									</td>
									<td align="center">
											Location<br />
											B
									</td>
									<td align="center">
											Location<br />
											 C
									</td>
							</tr>
							<tr>
									<td>
											Start Time
									</td>
									<td>
											<input type="text" name="" col_val="start_time" class="textbox2 A" />
									</td>
									<td>
											<input type="text" name="" col_val="start_time"  class="textbox2 B" />
									</td>
									<td>
											<input type="text" name="" col_val="start_time" class="textbox2 C" />
									</td>
							</tr>
							<tr>
									<td>
											Cycle Length
									</td>
									<td>
											<input type="text" name="" col_val="cycle_length"  class="textbox2 A" />
									</td>
									<td>
											<input type="text" name="" col_val="cycle_length"  class="textbox2 B" />
									</td>
									<td>
											<input type="text" name="" col_val="cycle_length"  class="textbox2 C" />
									</td>
							</tr>
							<tr>
									<td>
											Arrival Open
									</td>
									<td>
											<input type="text" name="" col_val="arrival_open"  class="textbox2 A" />
									</td>
									<td>
											<input type="text" name="" col_val="arrival_open"  class="textbox2 B" />
									</td>
									<td>
											<input type="text" name="" col_val="arrival_open"  class="textbox2 C" />
									</td>
							</tr>
							
							<tr>
									<td>
											Arrival Close
									</td>
									<td>
											<input type="text" name="" col_val="arrival_close"  class="textbox2 A" />
									</td>
									<td>
											<input type="text" name=""  col_val="arrival_close" class="textbox2 B" />
									</td>
									<td>
											<input type="text" name="" col_val="arrival_close" class="textbox2 C" />
									</td>
							</tr>
							
							<tr>
									<td colspan="2">
											<input type="button" value="Cancel" class="" />
									</td>
									<td colspan="2">
											<input type="button" value="Save Changes" class="" id="save"/>
									</td>
									
							</tr>
							
							<tr>
							<td><input type="hidden" name="id" id="id" value="" /></td>
							<td colspan="3" id="userList">jhbdksdhjkdshfkskdjfsd</td></tr>
					</table>
				
				
				
					
			</div>
	</div>
</body>
</html>
