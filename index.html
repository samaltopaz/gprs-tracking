<!DOCTYPE html>
<html>
  <head>
    <title>Device Properties Example</title>

    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">

    // Wait for Cordova to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);
     var db = window.openDatabase("Database", "1.0", "gps", 200000);

    // Cordova is ready
    //
    //function onDeviceReady() {
        //navigator.geolocation.getCurrentPosition(onSuccess, onError);
    //}

var watchID = null;


function onDeviceReady() {
  
  
        // Update every 1 seconds
        //window.setInterval(function(){
      var options = { frequency: 1000, enableHighAccuracy: true };
        watchID = navigator.geolocation.watchPosition(onSuccess, onError, options);
          
        //},1000);
        db.transaction(populateDB, errorCB, successCB);
        
    }
    
    
    
    function populateDB(tx){
        //Create the table
        //tx.executeSql('DROP TABLE IF EXISTS MyContacts');
        tx.executeSql('CREATE TABLE IF NOT EXISTS lat_long (id INTEGER PRIMARY KEY AUTOINCREMENT,latitude VARCHAR(80),longitude VARCHAR(80),altitude VARCHAR(30), Accuracy VARCHAR(30),altitudeaccuracy VARCHAR(30),heading VARCHAR(30),speed VARCHAR(30),timestamp VARCHAR(30))');
        
    }
    function successCB() {
          
            alert("table created successfully");
        }
   function errorCB(err)
   {
           alert("sqlerror:"+err.message);
   }
    


    // onSuccess Geolocation
    //
    function onSuccess(position) {
       var db = window.openDatabase("Database", "1.0", "gps", 200000);

     
        var element = document.getElementById('geolocation');
        element.innerHTML = 'Latitude: '           + position.coords.latitude              + '<br />' +
                            'Longitude: '          + position.coords.longitude             + '<br />' +
                            'Altitude: '           + position.coords.altitude              + '<br />' +
                            'Accuracy: '           + position.coords.accuracy              + '<br />' +
                            'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                            'Heading: '            + position.coords.heading               + '<br />' +
                            'Speed: '              + position.coords.speed                 + '<br />' +
                            'Timestamp: '          +                                   position.timestamp          + '<br />';
                            
   
   
    
    
     db.transaction(function (tx){
                 
      alert("INSERT INTO lat_long(latitude,longitude,altitude,accuracy,altitudeaccuracy,heading,speed,timestamp) VALUES ("+position.coords.latitude+","+position.coords.longitude+","+position.coords.altitude+","+position.coords.accuracy+","+position.coords.altitudeAccuracy+","+position.coords.heading+","+position.coords.speed+","+position.timestamp+")");           
               
tx.executeSql("INSERT INTO lat_long(latitude,longitude,altitude,accuracy,altitudeaccuracy,heading,speed,timestamp) VALUES ('"+position.coords.latitude+"','"+position.coords.longitude+"','"+position.coords.altitude+"','"+position.coords.accuracy+"','"+position.coords.altitudeAccuracy+"','"+position.coords.heading+"','"+position.coords.speed+"','"+position.timestamp+"')");

        
                 });  
                 
    }     
                 
                 
                 
                 
    
    

    // onError Callback receives a PositionError object
    //
    function onError(error) {
        alert('code: '    + error.code    + '\n' +
              'message: ' + error.message + '\n');
    }

    </script>
  </head>
  <body>
    <p id="geolocation">Finding geolocation...</p>
    <a href="firstform.htm">Next</a>
    <a href="distance.htm">Distance</a>
    <a href="distance2.htm">distance2</a>
    <a href="distance3.htm">lat_long info</a>
    <a href="getresult.htm">get result</a></br>
    <a href="insert_latlon">insert lat_lon</a></br>
  </body>
</html>
